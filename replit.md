# Школьный электронный дневник - Telegram Bot

## Обзор проекта

Полнофункциональный телеграм-бот для школьного электронного дневника, написанный на Go и интегрированный с API системы Эльжур. Бот позволяет студентам просматривать дневник, оценки, расписание, сообщения и учебные периоды через Telegram.

## Текущее состояние

### ✅ Реализовано:
- ✅ Полная структура проекта на Go с модульной архитектурой
- ✅ Расширенный API клиент для системы Эльжур (internal/eljur/)
- ✅ Все основные команды бота (/start, /help, /login, /logout, /diary, /periods, /messages, /schedule, /marks)
- ✅ Система состояний пользователей (internal/bot/)
- ✅ Интерактивные клавиатуры и навигация
- ✅ Авторизация пользователей
- ✅ Выбор учебных недель и периодов
- ✅ Отображение дневника с оценками
- ✅ Просмотр и отправка сообщений
- ✅ Просмотр расписания занятий
- ✅ Просмотр оценок по четвертям
- ✅ Webhook для деплоя на Vercel (api/webhook.go)
- ✅ Конфигурация для Vercel (vercel.json)

## Архитектура проекта

```
school-diary-bot/
├── main.go                    # Основной файл для локального запуска
├── api/webhook.go            # Webhook для Vercel
├── internal/
│   ├── bot/                  # Логика бота и обработчики
│   │   ├── types.go         # Типы и структуры
│   │   └── handlers.go      # Обработчики команд и сообщений
│   └── eljur/               # API клиент для Эльжур
│       └── client.go        # Полный клиент с всеми методами
├── go.mod                    # Зависимости Go
├── go.sum                    # Контрольные суммы зависимостей
├── vercel.json              # Конфигурация Vercel
├── deploy_instructions.md   # Инструкции по деплою
└── .gitignore               # Игнорируемые файлы
```

## API Эльжур

Интеграция с API мобильного приложения Эльжур:
- **BASE_URL**: `https://eljur.gospmr.org/apiv3/`
- **DEV_KEY**: `dd06cf484d85581e1976d93c639deee7`

### Основные методы:
- `Authenticate(login, password)` - авторизация
- `GetPeriods(weeks, showDisabled)` - получение учебных периодов
- `GetDiary(days)` - получение дневника за период
- `GetMessages(folder)` - получение сообщений (входящие/отправленные)
- `SendMessage(recipients, subject, text)` - отправка сообщений
- `GetMessageDetails(messageID)` - детали сообщения
- `GetMessageReceivers()` - список получателей
- `GetSchedule(days, classID)` - расписание занятий
- `GetMarks(period, startDate, endDate)` - оценки по периодам

## Команды бота

- `/start` - Главное меню с интерактивными кнопками
- `/help` - Подробная справка по использованию
- `/login` - Авторизация в системе Эльжур
- `/logout` - Выход из системы
- `/diary` - Просмотр дневника с выбором недель
- `/periods` - Учебные периоды и четверти
- `/messages` - Просмотр и отправка сообщений
- `/schedule` - Расписание занятий
- `/marks` - Оценки по четвертям

### Интерактивные возможности:
- Выбор недель для просмотра дневника
- Выбор четвертей для просмотра оценок
- Просмотр входящих и отправленных сообщений
- Отправка сообщений преподавателям
- Навигация через inline клавиатуры

## Деплой

### Локальный запуск:
```bash
export TELEGRAM_BOT_TOKEN="your_bot_token"
go run main.go
```

### Деплой на Vercel:
1. Настроить переменную окружения `TELEGRAM_BOT_TOKEN`
2. Настроить webhook в Telegram Bot API
3. Деплой выполняется через `vercel.json`

## Переменные окружения

- `TELEGRAM_BOT_TOKEN` - токен Telegram бота (обязательно)
- `ELJUR_API_URL` - URL API Эльжур (обязательно, например: https://eljur.gospmr.org/apiv3/)
- `ELJUR_DEV_KEY` - ключ разработчика Эльжур (обязательно)

## Технические детали

### Зависимости:
- `github.com/go-telegram-bot-api/telegram-bot-api/v5` v5.5.1

### Go версия: 1.19

## Пример использования

### Авторизация:
Логин: `Ivanov`
Пароль: `password123`

### Возможности после авторизации:
- Просмотр дневника с оценками и домашними заданиями
- Выбор любой недели из любой четверти
- Просмотр расписания занятий с указанием времени и кабинетов
- Просмотр оценок с автоматическим расчетом среднего балла
- Отправка и получение сообщений от преподавателей
- Навигация через удобные кнопки

## Готово к использованию

✅ Проект полностью готов к деплою и использованию
✅ Все основные функции электронного дневника реализованы
✅ Удобный интерфейс с интерактивными кнопками
✅ Безопасная авторизация через API Эльжур
✅ Поддержка как локального запуска, так и деплоя на Vercel

---

*Дата создания: 03.09.2025*
*Последнее обновление: 03.09.2025*
*Статус: ✅ Готов к использованию*